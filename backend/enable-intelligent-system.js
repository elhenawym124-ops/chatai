const { PrismaClient } = require('@prisma/client');

/**
 * ุชูุนูู ุงููุธุงู ุงูุฐูู ุงูุฌุฏูุฏ
 * ูููู ุจุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุดุฑูุฉ ูุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฐูู ุงูุทุจูุนู
 */

async function enableIntelligentSystem() {
  const prisma = new PrismaClient();
  
  try {
    console.log('๐ง ุจุฏุก ุชูุนูู ุงููุธุงู ุงูุฐูู ุงูุทุจูุนู...\n');
    
    // ุงูุญุตูู ุนูู ุฌููุน ุงูุดุฑูุงุช
    const companies = await prisma.company.findMany({
      select: { id: true, name: true }
    });
    
    console.log(`๐ ุชู ุงูุนุซูุฑ ุนูู ${companies.length} ุดุฑูุฉ\n`);
    
    for (const company of companies) {
      console.log(`๐ข ูุนุงูุฌุฉ ุงูุดุฑูุฉ: ${company.name} (${company.id})`);
      
      // ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฐูุงุก ุงูุตูุงุนู ูููุธุงู ุงูุฐูู
      const aiSettings = await prisma.aiSettings.upsert({
        where: { companyId: company.id },
        update: {
          // ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงูุฐูู
          autoSuggestProducts: true,  // ููุนู ููู ุจุฐูุงุก
          maxSuggestions: 3,          // ุนุฏุฏ ููุงุณุจ
          includeImages: true,        // ุชุถููู ุตูุฑ
          confidenceThreshold: 0.8,   // ุซูุฉ ุนุงููุฉ
          
          // Prompts ุฐููุฉ ุฌุฏูุฏุฉ
          personalityPrompt: `ุฃูุช ุณุงุฑูุ ูุณุงุนุฏุฉ ูุจูุนุงุช ุฐููุฉ ูุทุจูุนูุฉ
- ุชุชุญุฏุซูู ุจุทุฑููุฉ ูุฏูุฏุฉ ูููููุฉ
- ุชุณุชุฎุฏููู ุงููุบุฉ ุงูุนุงููุฉ ุงููุตุฑูุฉ
- ุชููููู ููุฉ ุงูุนููู ูุจู ุงูุชุฑุงุญ ุงูููุชุฌุงุช
- ูุง ุชูุชุฑุญู ููุชุฌุงุช ูุน ุงูุชุญูุงุช ุงูุจุณูุทุฉ
- ุชูุชุฑุญู ุงูููุชุฌุงุช ููุท ุนูุฏ ุงูุญุงุฌุฉ ุงููุนููุฉ`,

          responsePrompt: `ููุงุนุฏ ุงูุฑุฏ ุงูุฐูู:

๐ง ุชุญููู ููุฉ ุงูุนููู:
- ุชุญูุฉ ุจุณูุทุฉ (ูุฑุญุจุงุ ุงูุณูุงู ุนูููู) โ ุฑุฏ ุจุงูุชุญูุฉ ููุท
- ุทูุจ ููุชุฌุงุช (ุนุงูุฒุ ุฃุฑูุฏุ ุงุนุฑุถ) โ ุงุนุฑุถู ุงูููุชุฌุงุช
- ุณุคุงู ุนู ุฎุฏูุฉ (ุดุญูุ ุฏูุน) โ ุฃุฌูุจู ุนูู ุงูุณุคุงู
- ุดูุฑ ููุฏุงุน โ ุฑุฏ ููุงุณุจ ุจุฏูู ููุชุฌุงุช

๐ฌ ุฃุณููุจ ุงููุญุงุฏุซุฉ:
- ุทุจูุนู ููุฏูุฏ
- ูุฎุชุตุฑ ููููุฏ
- ุงุณุชุฎุฏุงู ุงูุฅูููุฌู ุจุฐูุงุก
- ุฃุณุฆูุฉ ุชูุงุนููุฉ ููุงุณุจุฉ

๐๏ธ ุนุฑุถ ุงูููุชุฌุงุช:
- ููุท ุนูุฏ ุงูุทูุจ ุงูุตุฑูุญ
- ูุน ุงูุตูุฑ ูุงูุชูุงุตูู
- ุฃุณุนุงุฑ ูุงุถุญุฉ
- ุณุคุงู ุชูุงุนูู ูู ุงูููุงูุฉ`,

          modelSettings: JSON.stringify({
            systemType: 'intelligent-natural',
            version: '1.0',
            features: {
              intentDetection: true,
              contextAwareness: true,
              naturalConversation: true,
              smartProductSuggestion: true,
              sentimentAnalysis: true,
              conversationMemory: true
            },
            rules: {
              noProductsWithGreetings: true,
              noProductsWithThanks: true,
              onlyWhenRequested: true,
              contextualSuggestions: true
            }
          }),
          
          updatedAt: new Date()
        },
        create: {
          companyId: company.id,
          autoReplyEnabled: true,
          autoSuggestProducts: true,
          maxSuggestions: 3,
          includeImages: true,
          confidenceThreshold: 0.8,
          personalityPrompt: `ุฃูุช ุณุงุฑูุ ูุณุงุนุฏุฉ ูุจูุนุงุช ุฐููุฉ ูุทุจูุนูุฉ
- ุชุชุญุฏุซูู ุจุทุฑููุฉ ูุฏูุฏุฉ ูููููุฉ
- ุชุณุชุฎุฏููู ุงููุบุฉ ุงูุนุงููุฉ ุงููุตุฑูุฉ
- ุชููููู ููุฉ ุงูุนููู ูุจู ุงูุชุฑุงุญ ุงูููุชุฌุงุช
- ูุง ุชูุชุฑุญู ููุชุฌุงุช ูุน ุงูุชุญูุงุช ุงูุจุณูุทุฉ
- ุชูุชุฑุญู ุงูููุชุฌุงุช ููุท ุนูุฏ ุงูุญุงุฌุฉ ุงููุนููุฉ`,
          responsePrompt: `ููุงุนุฏ ุงูุฑุฏ ุงูุฐูู:

๐ง ุชุญููู ููุฉ ุงูุนููู:
- ุชุญูุฉ ุจุณูุทุฉ (ูุฑุญุจุงุ ุงูุณูุงู ุนูููู) โ ุฑุฏ ุจุงูุชุญูุฉ ููุท
- ุทูุจ ููุชุฌุงุช (ุนุงูุฒุ ุฃุฑูุฏุ ุงุนุฑุถ) โ ุงุนุฑุถู ุงูููุชุฌุงุช
- ุณุคุงู ุนู ุฎุฏูุฉ (ุดุญูุ ุฏูุน) โ ุฃุฌูุจู ุนูู ุงูุณุคุงู
- ุดูุฑ ููุฏุงุน โ ุฑุฏ ููุงุณุจ ุจุฏูู ููุชุฌุงุช

๐ฌ ุฃุณููุจ ุงููุญุงุฏุซุฉ:
- ุทุจูุนู ููุฏูุฏ
- ูุฎุชุตุฑ ููููุฏ
- ุงุณุชุฎุฏุงู ุงูุฅูููุฌู ุจุฐูุงุก
- ุฃุณุฆูุฉ ุชูุงุนููุฉ ููุงุณุจุฉ

๐๏ธ ุนุฑุถ ุงูููุชุฌุงุช:
- ููุท ุนูุฏ ุงูุทูุจ ุงูุตุฑูุญ
- ูุน ุงูุตูุฑ ูุงูุชูุงุตูู
- ุฃุณุนุงุฑ ูุงุถุญุฉ
- ุณุคุงู ุชูุงุนูู ูู ุงูููุงูุฉ`,
          escalationRules: '{}',
          modelSettings: JSON.stringify({
            systemType: 'intelligent-natural',
            version: '1.0',
            features: {
              intentDetection: true,
              contextAwareness: true,
              naturalConversation: true,
              smartProductSuggestion: true,
              sentimentAnalysis: true,
              conversationMemory: true
            }
          })
        }
      });
      
      console.log(`   โ ุชู ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฐูุงุก ุงูุตูุงุนู`);
      console.log(`   ๐ง ุงููุธุงู ุงูุฐูู: ููุนู`);
      console.log(`   ๐ฏ ุงูุชุดุงู ุงูููุฉ: ููุนู`);
      console.log(`   ๐ฌ ุงููุญุงุฏุซุฉ ุงูุทุจูุนูุฉ: ููุนูุฉ`);
      console.log('');
    }
    
    console.log('\n๐ ุชู ุชูุนูู ุงููุธุงู ุงูุฐูู ุงูุทุจูุนู ุจูุฌุงุญ!');
    console.log('\n๐ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ:');
    console.log('   ๐ง ุชุญููู ููุฉ ุงูุนููู ุงูุฐูู');
    console.log('   ๐ฌ ูุญุงุฏุซุฉ ุทุจูุนูุฉ ููุฏูุฏุฉ');
    console.log('   ๐ฏ ุงูุชุฑุงุญ ููุชุฌุงุช ุญุณุจ ุงูุณูุงู');
    console.log('   ๐ซ ุนุฏู ุฅุฒุนุงุฌ ุงูุนููุงุก ุจููุชุฌุงุช ุบูุฑ ูุทููุจุฉ');
    console.log('   ๐ ุชุญููู ุงููุดุงุนุฑ ูุงูุณูุงู');
    console.log('   ๐ง ุฐุงูุฑุฉ ูุญุงุฏุซุฉ ุฐููุฉ');
    
    console.log('\n๐ก ููููุฉ ุงูุงุณุชุฎุฏุงู:');
    console.log('   โข ุงููุธุงู ุณูุนูู ุชููุงุฆูุงู ูุน ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ');
    console.log('   โข ูููู ุงุฎุชุจุงุฑู ุนุจุฑ: POST /api/v1/ai/test-intelligent');
    console.log('   โข ูุฑุงูุจุฉ ุงูุฅุญุตุงุฆูุงุช ุนุจุฑ: GET /api/v1/ai/intelligent-analytics');
    console.log('   โข ุงุณุชุฎุฏุงู ุงููุธุงู ุนุจุฑ: POST /api/v1/ai/intelligent-response');
    
    console.log('\n๐ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู ูุทููุจุฉ ูุชูุนูู ุงููุธุงู ุงูุฌุฏูุฏ');
    
  } catch (error) {
    console.error('โ ุฎุทุฃ ูู ุชูุนูู ุงููุธุงู ุงูุฐูู:', error);
  } finally {
    await prisma.$disconnect();
  }
}

// ุชุดุบูู ุงูุฏุงูุฉ
enableIntelligentSystem();
