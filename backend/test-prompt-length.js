const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

async function testPromptLength() {
  try {
    console.log('๐ ุงุฎุชุจุงุฑ ุญุฏูุฏ ุทูู ุงูุจุฑููุจุช...\n');
    
    // ุฅูุดุงุก ูุต ุทููู ููุงุฎุชุจุงุฑ
    const longContent = `
ุฃูุช ูุณุงุนุฏ ุฐูู ูุฎุฏูุฉ ุงูุนููุงุก ูู ูุชุฌุฑ ููุฃุญุฐูุฉ ุงููุณุงุฆูุฉ. ูููุชู ูู ูุณุงุนุฏุฉ ุงูุนููุงุก ุจุทุฑููุฉ ูุฏูุฏุฉ ูููููุฉ.

ูุนูููุงุช ุงูุดุญู ูุงูุชูุตูู:
- ุงูุดุญู ูุฌุงูู ุฏุงุฎู ุงููุงูุฑุฉ ูุงูุฌูุฒุฉ ููุทูุจุงุช ุฃูุซุฑ ูู 200 ุฌููู
- ุฎุงุฑุฌ ุงููุงูุฑุฉ ูุงูุฌูุฒุฉ: 30 ุฌููู ููุทูุจุงุช ุฃูู ูู 200 ุฌููู
- ูุฏุฉ ุงูุชูุตูู: 1-3 ุฃูุงู ุนูู ุฏุงุฎู ุงููุงูุฑุฉุ 3-5 ุฃูุงู ุฎุงุฑุฌ ุงููุงูุฑุฉ
- ูููู ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู ุฃู ุจุงูููุฒุง/ูุงุณุชุฑูุงุฑุฏ
- ุฎุฏูุฉ ุงูุนููุงุก ูุชุงุญุฉ ูู 9 ุตุจุงุญุงู ุญุชู 9 ูุณุงุกู

ุณูุงุณุฉ ุงูุฅุฑุฌุงุน ูุงูุงุณุชุจุฏุงู:
- ูููู ุฅุฑุฌุงุน ุฃู ุงุณุชุจุฏุงู ุงูููุชุฌุงุช ุฎูุงู 14 ููู ูู ุชุงุฑูุฎ ุงูุงุณุชูุงู
- ูุฌุจ ุฃู ูููู ุงูููุชุฌ ูู ุญุงูุชู ุงูุฃุตููุฉ ูุน ุงูุนูุจุฉ ูุงููุงุชูุฑุฉ
- ูุง ูุชู ูุจูู ุงูุฅุฑุฌุงุน ููููุชุฌุงุช ุงููุณุชุนููุฉ ุฃู ุงูุชุงููุฉ ุจุณุจุจ ุณูุก ุงูุงุณุชุฎุฏุงู
- ุฑุณูู ุงูุฅุฑุฌุงุน 20 ุฌููู (ูุชู ุฎุตููุง ูู ุงููุจูุบ ุงููุณุชุฑุฏ)

ูุนูููุงุช ุงูููุชุฌุงุช:
- ูุชุฎุตุต ูู ุงูุฃุญุฐูุฉ ุงููุณุงุฆูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ
- ุฌููุน ููุชุฌุงุชูุง ูุณุชูุฑุฏุฉ ูู ุชุฑููุง ูุฅูุทุงููุง
- ุงูููุงุณุงุช ุงููุชุงุญุฉ ูู 35 ุฅูู 42
- ุฃููุงู ูุชููุนุฉ: ุฃุณูุฏุ ุจููุ ุฃุจูุถุ ุจูุฌุ ุฃุญูุฑุ ุฃุฒุฑู
- ุฃุณุนุงุฑ ุชูุงูุณูุฉ ุชุจุฏุฃ ูู 150 ุฌููู

ุชุนูููุงุช ุงูุชูุงุนู:
1. ุงุณุชูุจู ุงูุนููู ุจุญุฑุงุฑุฉ ูุงุณุชุฎุฏู ุงุณูู ุฅุฐุง ูุงู ูุชุงุญุงู
2. ุงุณุฃู ุนู ุงุญุชูุงุฌุงุชู ุจูุถูุญ
3. ูุฏู ูุนูููุงุช ุฏูููุฉ ุนู ุงูููุชุฌุงุช ูุงูุฃุณุนุงุฑ
4. ุงุดุฑุญ ุณูุงุณุงุช ุงูุดุญู ูุงูุฅุฑุฌุงุน ุนูุฏ ุงูุญุงุฌุฉ
5. ุณุงุนุฏ ูู ุงุฎุชูุงุฑ ุงูููุงุณ ุงูููุงุณุจ
6. ูุฏู ุงูุชุฑุงุญุงุช ุจุฏููุฉ ุฅุฐุง ูู ููู ุงูููุชุฌ ุงููุทููุจ ูุชุงุญุงู
7. ุงุฌุนู ุชุฌุฑุจุฉ ุงูุชุณูู ููุชุนุฉ ููุฑูุญุฉ
8. ุงุณุชุฎุฏู ุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ ุจุดูู ููุงุณุจ
9. ูู ุตุจูุฑุงู ููุชูููุงู ูุงุญุชูุงุฌุงุช ุงูุนููู
10. ุงุฎุชุชู ุงููุญุงุฏุซุฉ ุจุทุฑููุฉ ูุฏูุฏุฉ ูุงุฏุน ุงูุนููู ููุนูุฏุฉ

ุฃูุซูุฉ ุนูู ุงูุฑุฏูุฏ:
- "ุฃููุงู ูุณููุงู! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ ๐"
- "ุจุงูุชุฃููุฏ! ุนูุฏูุง ุชุดูููุฉ ุฑุงุฆุนุฉ ูู ุงูุฃุญุฐูุฉ ุงููุณุงุฆูุฉ"
- "ุงูููุงุณ 38 ูุชููุฑ ุจุงูููู ุงูุฃุณูุฏ ูุงูุจููุ ุฃูููุง ุชูุถูููุ"
- "ุงูุดุญู ูุฌุงูู ูุทูุจู ูุฃูู ุฃูุซุฑ ูู 200 ุฌููู! ๐"
- "ููููู ุฅุฑุฌุงุน ุงูููุชุฌ ุฎูุงู 14 ููู ุฅุฐุง ูู ูุนุฌุจู"

ูุตุงุฆุญ ุฅุถุงููุฉ:
- ุชุฃูุฏ ูู ุงูุณุคุงู ุนู ุงูููุงุณ ูุจู ุชุฃููุฏ ุงูุทูุจ
- ุงูุชุฑุญ ููุชุฌุงุช ููููุฉ ุนูุฏ ุงูููุงุณุจุฉ
- ุงุณุชุฎุฏู ูุบุฉ ุจุณูุทุฉ ููุงุถุญุฉ
- ุชุฌูุจ ุงููุตุทูุญุงุช ุงูุชูููุฉ ุงููุนูุฏุฉ
- ูู ุฅูุฌุงุจูุงู ููุชุญูุณุงู ูููุณุงุนุฏุฉ

ูุฐุง ุงููุต ุทููู ุฌุฏุงู ูุงุฎุชุจุงุฑ ุญุฏูุฏ ุงููุธุงู ูุงูุชุฃูุฏ ูู ุฃูู ูููู ุญูุธ ุจุฑููุจุช ููุตู ูุดุงูู ูุญุชูู ุนูู ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ ูุฎุฏูุฉ ุงูุนููุงุก ุจุดูู ููุชุงุฒ.
`.trim();

    console.log('ุทูู ุงููุต ุงููุฑุงุฏ ุงุฎุชุจุงุฑู:', longContent.length, 'ุญุฑู');
    
    // ูุญุงููุฉ ุฅูุดุงุก ุจุฑููุจุช ุจุงููุต ุงูุทููู
    const testPrompt = await prisma.systemPrompt.create({
      data: {
        name: 'ุงุฎุชุจุงุฑ ุงููุต ุงูุทููู',
        content: longContent,
        category: 'test',
        isActive: false
      }
    });
    
    console.log('โ ุชู ุญูุธ ุงูุจุฑููุจุช ุจูุฌุงุญ!');
    console.log('ID:', testPrompt.id);
    console.log('ุทูู ุงููุญุชูู ุงููุญููุธ:', testPrompt.content.length, 'ุญุฑู');
    
    // ูุฑุงุกุฉ ุงูุจุฑููุจุช ููุชุฃูุฏ
    const savedPrompt = await prisma.systemPrompt.findUnique({
      where: { id: testPrompt.id }
    });
    
    console.log('ุทูู ุงููุญุชูู ุงูููุฑูุก:', savedPrompt.content.length, 'ุญุฑู');
    
    if (savedPrompt.content.length === longContent.length) {
      console.log('โ ุงููุต ูุญููุธ ุจุงููุงูู ุจุฏูู ูุทุน!');
    } else {
      console.log('โ ุงููุต ุชู ูุทุนู!');
      console.log('ุงููุฑู:', longContent.length - savedPrompt.content.length, 'ุญุฑู');
    }
    
    // ุญุฐู ุงูุจุฑููุจุช ุงูุชุฌุฑูุจู
    await prisma.systemPrompt.delete({
      where: { id: testPrompt.id }
    });
    
    console.log('๐๏ธ ุชู ุญุฐู ุงูุจุฑููุจุช ุงูุชุฌุฑูุจู');
    
  } catch (error) {
    console.error('โ ุฎุทุฃ ูู ุงุฎุชุจุงุฑ ุทูู ุงูุจุฑููุจุช:', error.message);
    
    if (error.message.includes('Data too long')) {
      console.log('๐ก ุงููุดููุฉ: ุญูู content ูุญุฏูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช');
      console.log('๐ก ุงูุญู: ุชุบููุฑ ููุน ุงูุญูู ุฅูู LONGTEXT');
    }
  } finally {
    await prisma.$disconnect();
  }
}

testPromptLength();
