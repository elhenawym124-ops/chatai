# ๐ง ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก - Troubleshooting Guide

## ๐ **ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 12 ุฃุบุณุทุณ 2025

---

## ๐๏ธ **ูุดุงูู ูุธุงู ุงูุชุญูู ูู ุงูุฃููุงุท - ุงูุฅุตุฏุงุฑ 2.2.0**

### **โ ุฃุฎุทุงุก JavaScript Syntax**

#### ุงููุดููุฉ: `Unexpected token ','`
```
SyntaxError: Unexpected token ','
```

**ุงูุณุจุจ:** ููุงุตู ุฎุงุทุฆุฉ ูู class methods

**ุงูุญู:**
```javascript
// โ ุฎุทุฃ
class MyClass {
  async method1() {
    return 'test';
  },  // ูุงุตูุฉ ุฎุงุทุฆุฉ
}

// โ ุตุญูุญ
class MyClass {
  async method1() {
    return 'test';
  }  // ุจุฏูู ูุงุตูุฉ
}
```

#### ุงููุดููุฉ: `Function is not defined`
```
successAnalyticsAPI.getPatternPerformance is not a function
```

**ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ ุงูุฏุงูุฉ ูู `successAnalyticsAPI.js`
2. ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ (Ctrl+F5)
3. ูุณุญ cache ุงููุชุตูุญ

### **๐ ูุดุงูู APIs ุงูุฌุฏูุฏุฉ**

#### ุงููุดููุฉ: `Cannot GET /system/status`
**ุงูุญู:**
```bash
# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
cd backend
node server.js
```

#### ุงููุดููุฉ: ุงููุธุงู ูุง ูุณุชุฌูุจ ููุชูุนูู/ุงูุฅููุงู
**ุงูุชุดุฎูุต:**
```javascript
// ูุญุต ุญุงูุฉ ุงููุธุงู
const status = await successAnalyticsAPI.getPatternSystemStatus();
console.log('ุญุงูุฉ ุงููุธุงู:', status);
```

---

## ๐จ **ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุญููููุง ุงูุณุฑูุนุฉ**

### **1๏ธโฃ ุงููุธุงู ูุง ูุณุฌู ุงุณุชุฎุฏุงู ุงูุฃููุงุท**

**๐ ุงูุฃุนุฑุงุถ:**
- ุงููุงุฌูุฉ ุชุธูุฑ ุนุฏุฏ ุงุณุชุฎุฏุงูุงุช ูููู (7 ุฃู ุฃูู)
- ูุง ุชุธูุฑ ุฑุณุงุฆู ุงูุชุณุฌูู ูู ุงูููุฌ
- ูุนุฏู ุงููุฌุงุญ ุบูุฑ ูุงูุนู (95%+)

**๐ง ุงูุญู ุงูุณุฑูุน:**
```bash
# 1. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
Ctrl+C
npm start

# 2. ูุฑุงูุจุฉ ุงูููุฌ ููุชุฃูุฏ ูู ุธููุฑ:
# ๐ [AIAgent] Recording usage for X patterns
# โ [AIAgent] Successfully recorded usage for X patterns
```

**๐ ุงูุชุญูู ูู ุงูุญู:**
```bash
# ูุญุต API ููุชุฃูุฏ ูู ุฒูุงุฏุฉ ุงูุนุฏุงุฏ
curl -X GET "http://localhost:3001/api/v1/success-learning/pattern-performance?companyId=cme4yvrco002kuftceydlrwdi"
```

---

### **2๏ธโฃ ุงููุธุงู ูููู ุงูุณูุงู ุฎุทุฃ**

**๐ ุงูุฃุนุฑุงุถ:**
- ุงูุนููู ูููู "ุงู ูุง ุฑูุช" ููููููุง ุงููุธุงู ูุชุฃููุฏ ุทูุจ
- ุฑุฏูุฏ ุบูุฑ ููุงุณุจุฉ ููุณูุงู
- ููู ุฎุงุทุฆ ููููุงุตุฏ

**๐ง ุงูุญู:**
```javascript
// ุชุญูู ูู ุขุฎุฑ ุชุญุฏูุซ ูููุทู ุงูุชุดุงู ุงูุชุฃููุฏ
// ูู ููู: backend/src/services/aiAgentService.js
// ุงูุณุทุฑ: 1570-1632

// ูุฌุจ ุฃู ูุญุชูู ุนูู ููุงุนุฏ ุงูุณูุงู ุงูุฌุฏูุฏุฉ:
// 1๏ธโฃ ุฅุฐุง ูุงู ุขุฎุฑ ุฑุฏ ูุณุฃู ุนู ูุนูููุงุช ุฅุถุงููุฉ
// 2๏ธโฃ ุฅุฐุง ูุงู ุขุฎุฑ ุฑุฏ ูุทูุจ ุชุฃููุฏ ุตุฑูุญ
```

**๐งช ุงุฎุชุจุงุฑ ุงูุญู:**
```
ูุญุงุฏุซุฉ ุงุฎุชุจุงุฑ:
1. ุงูุนููู: "ุจูุงู ุงูููุชุดูุ"
2. ุงููุธุงู: "ุงูุณุนุฑ 349 ุฌููู. ุชุญุจ ุชุนุฑู ุงูููุงุณุงุชุ"
3. ุงูุนููู: "ุงู ูุง ุฑูุช"
4. ุงููุธุงู: ูุฌุจ ุฃู ูุนุทู ูุนูููุงุช ุงูููุงุณุงุช (ููุณ ุชุฃููุฏ ุทูุจ)
```

---

### **3๏ธโฃ ุชุถุงุฑุจ ุงูุจูุงูุงุช ุจูู ุงููุงุฌูุฉ ูุงูู API**

**๐ ุงูุฃุนุฑุงุถ:**
- ุงููุงุฌูุฉ ุชุธูุฑ: 95% ูุฌุงุญุ 10 ุงุณุชุฎุฏุงูุงุช
- API ูุธูุฑ: 58% ูุฌุงุญุ 7 ุงุณุชุฎุฏุงูุงุช
- ุฃุฑูุงู ูุฎุชููุฉ ูู ุฃูุงูู ูุฎุชููุฉ

**๐ง ุงูุญู:**
```bash
# ุชุดุบูู ุณูุฑูุจุช ุฅุตูุงุญ ุงูุจูุงูุงุช
cd backend
node fix-pattern-usage-tracking.js
```

**๐ ุงูุชุญูู:**
```bash
# ููุงุฑูุฉ ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ
curl -X GET "http://localhost:3001/api/v1/success-learning/pattern-performance"
# ูุฌุจ ุฃู ุชุทุงุจู ุงูุจูุงูุงุช ูู ุงููุงุฌูุฉ
```

---

## โก **ูุดุงูู ุงูุฃุฏุงุก**

### **1๏ธโฃ ุจุทุก ูู ุงูุงุณุชุฌุงุจุฉ**

**๐ ุงูุฃุนุฑุงุถ:**
- ููุช ุงุณุชุฌุงุจุฉ ุฃูุซุฑ ูู 60 ุซุงููุฉ
- ุฑุณุงุฆู timeout ูู ุงูููุฌ
- ุงูุนููุงุก ูุดุชููู ูู ุงูุจุทุก

**๐ง ุงูุญููู:**

#### **ุฃ. ูุญุต ุญุฏูุฏ Gemini API:**
```bash
# ุงูุจุญุซ ูู ุงูููุฌ ุนู:
# โ Error: [429 Too Many Requests]
# ๐ ุชู ุชุฌุงูุฒ ุญุฏ ุงููููุฐุฌ

# ุงูุญู: ุชุฑููุฉ ุฎุทุฉ Gemini ุฃู ุฅุถุงูุฉ ููุงุชูุญ ุฅุถุงููุฉ
```

#### **ุจ. ุชุญุณูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```sql
-- ูุญุต ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
EXPLAIN ANALYZE SELECT * FROM "Message" WHERE "conversationId" = 'xxx';

-- ุฅุถุงูุฉ ููุงุฑุณ ุฅุฐุง ูุฒู ุงูุฃูุฑ
CREATE INDEX idx_message_conversation ON "Message"("conversationId");
```

#### **ุฌ. ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ:**
```bash
# ูุญุต ุงุณุชููุงู ุงูุฐุงูุฑุฉ
top -p $(pgrep node)

# ุฅุนุงุฏุฉ ุชุดุบูู ุฅุฐุง ูุงู ุงูุงุณุชููุงู ุนุงูู
pm2 restart all
```

---

### **2๏ธโฃ ุฃุฎุทุงุก ูู ุงูุงุชุตุงู**

**๐ ุงูุฃุนุฑุงุถ:**
```
โ Error getting Facebook user info: Request failed with status code 400
โ Connection timeout
โ ECONNREFUSED
```

**๐ง ุงูุญููู:**

#### **ุฃ. ุฃุฎุทุงุก Facebook API:**
```javascript
// ูุฐู ุฃุฎุทุงุก ุทุจูุนูุฉ - ุงููุธุงู ูุชุนุงูู ูุนูุง
// ูุง ุชุญุชุงุฌ ุฅุฌุฑุงุก ุฅูุง ุฅุฐุง ูุงูุช ุชุคุซุฑ ุนูู ุงูุฃุฏุงุก

// ููุชูููู ูู ุงูุฑุณุงุฆู:
// ุชุญุฏูุซ ูุณุชูู ุงูุชุณุฌูู ูู ุงูููุฏ
console.log(`โน๏ธ [Facebook] User ${userId} info not accessible`);
// ุจุฏูุงู ูู console.error
```

#### **ุจ. ุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```bash
# ูุญุต ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
npx prisma db pull

# ุฅุนุงุฏุฉ ุงูุงุชุตุงู
npx prisma generate
```

---

## ๐ง **ูุดุงูู ุงูุชูููู**

### **1๏ธโฃ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ููููุฏุฉ**

**๐ ุงูุฃุนุฑุงุถ:**
```
โ Error: Environment variable GEMINI_API_KEY is not defined
โ Database connection failed
```

**๐ง ุงูุญู:**
```bash
# ูุญุต ููู .env
cat .env

# ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงููุชุบูุฑุงุช ุงููุทููุจุฉ:
DATABASE_URL=
GEMINI_API_KEY_1=
FACEBOOK_PAGE_ACCESS_TOKEN=
WEBHOOK_VERIFY_TOKEN=
```

---

### **2๏ธโฃ ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**

**๐ ุงูุฃุนุฑุงุถ:**
```
prisma:error Invalid `prisma.message.create()` invocation
Foreign key constraint violated
```

**๐ง ุงูุญู:**
```bash
# ุฅุนุงุฏุฉ ุชุทุจูู ุงููุฎุทุทุงุช
npx prisma migrate reset
npx prisma migrate dev

# ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุนููู
npx prisma generate
```

---

## ๐ **ุฃุฏูุงุช ุงูุชุดุฎูุต**

### **1๏ธโฃ ูุญุต ุญุงูุฉ ุงููุธุงู**

```bash
# ูุญุต ุงูุฎุฏูุงุช
curl -X GET "http://localhost:3001/api/v1/health"

# ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช
npx prisma db pull

# ูุญุต ุงูุฐุงูุฑุฉ ูุงููุนุงูุฌ
htop
```

### **2๏ธโฃ ูุฑุงูุจุฉ ุงูููุฌ**

```bash
# ูุฑุงูุจุฉ ุงูููุฌ ูู ุงูููุช ุงููุนูู
tail -f logs/app.log

# ุงูุจุญุซ ุนู ุฃุฎุทุงุก ูุญุฏุฏุฉ
grep "ERROR" logs/app.log | tail -20

# ูุญุต ุฃุฏุงุก ุงูุฃููุงุท
grep "Pattern" logs/app.log | tail -10
```

### **3๏ธโฃ ุงุฎุชุจุงุฑ ุงูู API**

```bash
# ุงุฎุชุจุงุฑ ุงูุฃููุงุท
curl -X GET "http://localhost:3001/api/v1/success-learning/patterns"

# ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก
curl -X GET "http://localhost:3001/api/v1/success-learning/pattern-performance"

# ุงุฎุชุจุงุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
curl -X POST "http://localhost:3001/api/v1/ai/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "ูุฑุญุจุง"}'
```

---

## ๐จ **ุญุงูุงุช ุงูุทูุงุฑุฆ**

### **1๏ธโฃ ุงููุธุงู ูุชููู ุชูุงูุงู**

```bash
# 1. ูุญุต ุงูุนูููุงุช
ps aux | grep node

# 2. ูุชู ุงูุนูููุงุช ุงููุนููุฉ
pkill -f node

# 3. ุฅุนุงุฏุฉ ุชุดุบูู ูุงููุฉ
npm start

# 4. ูุญุต ุงูููุฌ ููุฃุฎุทุงุก
tail -f logs/app.log
```

### **2๏ธโฃ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุงููุฉ**

```bash
# 1. ูุณุฎ ุงุญุชูุงุทู ููุฑู
pg_dump chatbot_db > backup_$(date +%Y%m%d_%H%M%S).sql

# 2. ุฅุนุงุฏุฉ ุชุทุจูู ุงููุฎุทุทุงุช
npx prisma migrate reset --force

# 3. ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
psql chatbot_db < backup_latest.sql
```

### **3๏ธโฃ ุงุณุชููุงู ููุฑุท ููููุงุฑุฏ**

```bash
# 1. ูุญุต ุงูุงุณุชููุงู
top -p $(pgrep node)

# 2. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ
pm2 restart all

# 3. ุชูุธูู ุงูุฐุงูุฑุฉ
echo 3 > /proc/sys/vm/drop_caches
```

---

## ๐ **ุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉ**

### **๐ ูุจู ุทูุจ ุงููุณุงุนุฏุฉ:**
1. โ ุฑุงุฌุน ูุฐุง ุงูุฏููู
2. โ ูุญุต [ุงููุดุงูู ุงููุนุฑููุฉ](./known-issues.md)
3. โ ุฌุฑุจ ุงูุญููู ุงูุณุฑูุนุฉ
4. โ ุงุฌูุน ูุนูููุงุช ุงูุชุดุฎูุต

### **๐ ูุนูููุงุช ูุทููุจุฉ ุนูุฏ ุทูุจ ุงููุณุงุนุฏุฉ:**
- **ุงูููุช:** ูุชู ุญุฏุซุช ุงููุดููุฉุ
- **ุงูุฎุทูุงุช:** ููู ูููู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉุ
- **ุงูููุฌ:** ุขุฎุฑ 50 ุณุทุฑ ูู ุงูููุฌ
- **ุงูุจูุฆุฉ:** ุฅูุชุงุฌ ุฃู ุชุทููุฑุ
- **ุงูุฅุตุฏุงุฑ:** ุฃู ุฅุตุฏุงุฑ ูู ุงููุธุงูุ

### **๐ง ูููุงุช ุงูุฏุนู:**
- **ุงูุฏุนู ุงูุชููู:** support@example.com
- **ุงููุทูุฑูู:** developers@example.com
- **ุงูุทูุงุฑุฆ:** emergency@example.com

---

## ๐ **ููุงุฑุฏ ุฅุถุงููุฉ**

### **๐ ุงูุชูุซูู:**
- [ุฏููู ุงููุทูุฑ](./developer-guide.md)
- [ูุธุงู ุงูุฃููุงุท](./pattern-system.md)
- [ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ](./faq.md)

### **๐ ุฑูุงุจุท ูููุฏุฉ:**
- [Prisma Documentation](https://www.prisma.io/docs)
- [Gemini API Documentation](https://ai.google.dev/docs)
- [Facebook Graph API](https://developers.facebook.com/docs/graph-api)

---

*ูุฐุง ุงูุฏููู ูุชู ุชุญุฏูุซู ุจุงุณุชูุฑุงุฑ ูุน ุงูุชุดุงู ูุดุงูู ุฌุฏูุฏุฉ ูุญููููุง*
